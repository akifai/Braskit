<!DOCTYPE html>
<html>
<head>
  <title>
    {% if title %}{{ title }} - {% endif %}
    {% if board %}
      {% if not title %}/{{ board }}/ - {% endif %}
      {{ board.title }}
    {% else %}
      {{ app.config.site_name }}
    {% endif %}
  </title>

  <meta charset="utf-8">
  <link rel="stylesheet" id="sitestyle" href="{{ style.getDefault() }}">
  <script>
    var styles = {{ style.getJSON()|raw }};

    function changeStyle(name) {
      var linkEl = document.getElementById("sitestyle");

      if (linkEl)
        linkEl.href = styles[name];
    }

    (function () {
      var match = document.cookie.match(/(?:^|;\s+)style=(.*?)(?:;|$)/);

      if (!match || match.length < 2)
        return;

      changeStyle(unescape(match[1]));
    })();
  </script>
</head>
<body{% if js_callbacks %} data-callback="{{ js_callbacks|join(" ") }}"{% endif %}{% if not static %} data-csrf="{{ csrf() }}"{% endif %}>
  <div id="wrapper">
    {% include "header.html" %}

    {% block content %}{% endblock %}

    {% include "footer.html" %}
  </div>

  {% if app["js.debug"] %}
    {% for file in app["js.includes"] %}
      {# TODO: absolute paths #}
      <script src="{{ path("static/js/"~file) }}"></script>
    {% endfor %}
  {% else %}
    <script src="{{ js() }}"></script>
  {% endif %}
</body>
</html>
