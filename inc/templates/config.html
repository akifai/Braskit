{% extends _base %}

{% import "includes/macros.html" as m %}

{% set title = board
  ? "Editing config for /%s/"|format(board)
  : "Editing global config"
%}

{% set js_callbacks = ["doConfig"] %}

{% block content %}
  <form action="{{ board ? board.path("config", true) : path("config", true) }}" method="post" class="block-form fw-center">
    <input type="hidden" name="{{ app.csrf.getParamName() }}" value="{{ app.csrf.getToken() }}">

    <table class="list-table">
      <thead>
        <tr>
          <th>Key</th>
          <th>Value</th>
          <th>Reset</th>
        </tr>
      </thead>

      <tbody>
        {% for item in config_instance %}
          <tr>
            <td>
              <label for="config-{{ item.name|raw }}" title="{{ item.description }}">
                {% if item.modified %}
                  <strong>{{ item.name|raw }}</strong>
                {% else %}
                  {{ item.name|raw }}
                {% endif %}
              </label>
            </td>

            <td>
              {% if item.type == "boolean" %}
                <input type="checkbox" name="config[{{ item.name|raw }}]" value="on" id="config-{{ item.name|raw }}"{% if item.value %} checked{% endif %}>
              {% elseif item.type == "integer" %}
                <input type="number" name="config[{{ item.name|raw }}]" value="{{ item.value }}" id="config-{{ item.name|raw }}" size="8" min="0">
              {% elseif item.type == "string" %}
                <input type="text" name="config[{{ item.name|raw }}]" value="{{ item.value }}" id="config-{{ item.name|raw }}" size="35">
              {% endif %}
            </td>
            <td><input type="checkbox" name="reset[{{ item.name|raw }}]" value="on"{% if not item.modified %} disabled{% else %} data-default="{{ item.default }}"{% endif %} class="toggle-reset"></td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <p class="form-controls">
      <input type="submit" value="Edit Config">
    </p>
  </form>
{% endblock %}
